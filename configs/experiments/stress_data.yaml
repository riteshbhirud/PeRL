# PeRL Experiment Configuration
# Generated: 2026-02-05 01:42:46
#
# Usage:
#   python scripts/run_experiments.py --config stress_data.yaml
#   python scripts/validate_configs.py --config /Users/ritesh/per/PeRL/configs/experiments/stress_data.yaml
#
base:
  description: Data size stress test (4 methods × 4 sizes × 2 seeds = 32 experiments)
  model:
    model_name_or_path: deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B
    dtype: bfloat16
    attn_implementation: sdpa
  dataset:
    dataset_name_or_path: Jiayi-Pan/Countdown-Tasks-3to4
  training:
    max_steps: 1000
    save_steps: 100
    logging_steps: 10
    per_device_train_batch_size: 4
    gradient_accumulation_steps: 8
    num_generations: 8
    use_vllm: false
    use_liger_kernel: false
    report_to:
      - wandb
  tracker:
    enable_spectral_tracking: true
    enable_gradient_tracking: true
    spectral_log_frequency: 100
    gradient_log_frequency: 100
  wandb:
    use_wandb: true
    project: peft-rlvr-mechanistic
    log_spectral_images: true
    log_gradient_images: true
experiments:
  - name: lora_d1k_s42
    peft:
      type: lora
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 42
    dataset:
      example_numbers: 1000
  - name: lora_d1k_s123
    peft:
      type: lora
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 123
    dataset:
      example_numbers: 1000
  - name: lora_d4k_s42
    peft:
      type: lora
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 42
    dataset:
      example_numbers: 4000
  - name: lora_d4k_s123
    peft:
      type: lora
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 123
    dataset:
      example_numbers: 4000
  - name: lora_d8k_s42
    peft:
      type: lora
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 42
    dataset:
      example_numbers: 8500
  - name: lora_d8k_s123
    peft:
      type: lora
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 123
    dataset:
      example_numbers: 8500
  - name: lora_d17k_s42
    peft:
      type: lora
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 42
    dataset:
      example_numbers: 17000
  - name: lora_d17k_s123
    peft:
      type: lora
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 123
    dataset:
      example_numbers: 17000
  - name: dora_d1k_s42
    peft:
      type: dora
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 42
    dataset:
      example_numbers: 1000
  - name: dora_d1k_s123
    peft:
      type: dora
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 123
    dataset:
      example_numbers: 1000
  - name: dora_d4k_s42
    peft:
      type: dora
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 42
    dataset:
      example_numbers: 4000
  - name: dora_d4k_s123
    peft:
      type: dora
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 123
    dataset:
      example_numbers: 4000
  - name: dora_d8k_s42
    peft:
      type: dora
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 42
    dataset:
      example_numbers: 8500
  - name: dora_d8k_s123
    peft:
      type: dora
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 123
    dataset:
      example_numbers: 8500
  - name: dora_d17k_s42
    peft:
      type: dora
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 42
    dataset:
      example_numbers: 17000
  - name: dora_d17k_s123
    peft:
      type: dora
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 123
    dataset:
      example_numbers: 17000
  - name: pissa_d1k_s42
    peft:
      type: pissa
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 42
    dataset:
      example_numbers: 1000
  - name: pissa_d1k_s123
    peft:
      type: pissa
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 123
    dataset:
      example_numbers: 1000
  - name: pissa_d4k_s42
    peft:
      type: pissa
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 42
    dataset:
      example_numbers: 4000
  - name: pissa_d4k_s123
    peft:
      type: pissa
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 123
    dataset:
      example_numbers: 4000
  - name: pissa_d8k_s42
    peft:
      type: pissa
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 42
    dataset:
      example_numbers: 8500
  - name: pissa_d8k_s123
    peft:
      type: pissa
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 123
    dataset:
      example_numbers: 8500
  - name: pissa_d17k_s42
    peft:
      type: pissa
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 42
    dataset:
      example_numbers: 17000
  - name: pissa_d17k_s123
    peft:
      type: pissa
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 123
    dataset:
      example_numbers: 17000
  - name: milora_d1k_s42
    peft:
      type: milora
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 42
    dataset:
      example_numbers: 1000
  - name: milora_d1k_s123
    peft:
      type: milora
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 123
    dataset:
      example_numbers: 1000
  - name: milora_d4k_s42
    peft:
      type: milora
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 42
    dataset:
      example_numbers: 4000
  - name: milora_d4k_s123
    peft:
      type: milora
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 123
    dataset:
      example_numbers: 4000
  - name: milora_d8k_s42
    peft:
      type: milora
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 42
    dataset:
      example_numbers: 8500
  - name: milora_d8k_s123
    peft:
      type: milora
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 123
    dataset:
      example_numbers: 8500
  - name: milora_d17k_s42
    peft:
      type: milora
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 42
    dataset:
      example_numbers: 17000
  - name: milora_d17k_s123
    peft:
      type: milora
      r: 16
      lora_alpha: 32
    training:
      learning_rate: 1e-05
    common:
      seed: 123
    dataset:
      example_numbers: 17000
